-- Procedure Comptable--
DELIMITER $$

CREATE PROCEDURE Comptable_CRUD(
    IN action VARCHAR(10),
    IN p_id_Comptable INT,
    IN p_nom_Comptable VARCHAR(50),
    IN p_prenom_Comptable VARCHAR(50),
    IN p_telephone_Comptable_1 VARCHAR(15),
    IN p_telephone_Comptable_2 VARCHAR(15),
    IN p_mail_Comptable VARCHAR(50)
)
BEGIN
    IF action = 'CREATE' THEN
        INSERT INTO Comptable (
            nom_Comptable, prenom_Comptable, telephone_Comptable_1, 
            telephone_Comptable_2, mail_Comptable
        ) 
        VALUES (
            p_nom_Comptable, p_prenom_Comptable, p_telephone_Comptable_1, 
            p_telephone_Comptable_2, p_mail_Comptable
        );
    
    ELSEIF action = 'READ' THEN
        SELECT * FROM Comptable WHERE id_Comptable = p_id_Comptable;
    
    ELSEIF action = 'UPDATE' THEN
        UPDATE Comptable
        SET nom_Comptable = p_nom_Comptable,
            prenom_Comptable = p_prenom_Comptable,
            telephone_Comptable_1 = p_telephone_Comptable_1,
            telephone_Comptable_2 = p_telephone_Comptable_2,
            mail_Comptable = p_mail_Comptable
        WHERE id_Comptable = p_id_Comptable;
    
    ELSEIF action = 'DELETE' THEN
        DELETE FROM Comptable WHERE id_Comptable = p_id_Comptable;
    
    ELSE
        SIGNAL SQLSTATE '45000'
        SET MESSAGE_TEXT = 'Action non reconnue. Utilisez CREATE, READ, UPDATE ou DELETE.';
    END IF;
END$$

DELIMITER ;
-- Procedure salle --
DELIMITER $$

CREATE PROCEDURE Salle_CRUD(
    IN action VARCHAR(10),
    IN p_id_Salle INT,
    IN p_nom_Salle VARCHAR(50),
    IN p_type_Salle VARCHAR(50)
)
BEGIN
    IF action = 'CREATE' THEN
        INSERT INTO Salle (nom_Salle, type_Salle)
        VALUES (p_nom_Salle, p_type_Salle);
    
    ELSEIF action = 'READ' THEN
        SELECT * FROM Salle WHERE id_Salle = p_id_Salle;
    
    ELSEIF action = 'UPDATE' THEN
        UPDATE Salle
        SET nom_Salle = p_nom_Salle,
            type_Salle = p_type_Salle
        WHERE id_Salle = p_id_Salle;
    
    ELSEIF action = 'DELETE' THEN
        DELETE FROM Salle WHERE id_Salle = p_id_Salle;
    
    ELSE
        SIGNAL SQLSTATE '45000'
        SET MESSAGE_TEXT = 'Action non reconnue. Utilisez CREATE, READ, UPDATE ou DELETE.';
    END IF;
END$$

DELIMITER ;

-- Procedure receptionniste --
DELIMITER $$

CREATE PROCEDURE Receptionniste_CRUD(
    IN action VARCHAR(10),
    IN p_id_Receptionniste INT,
    IN p_nom_Receptionniste VARCHAR(50),
    IN p_prenom_Receptionniste VARCHAR(50),
    IN p_email_Receptionniste VARCHAR(50),
    IN p_telephone_Receptionniste_1 VARCHAR(15),
    IN p_telephone_Receptionniste_2 VARCHAR(15)
)
BEGIN
    IF action = 'CREATE' THEN
        INSERT INTO Receptionniste (
            nom_Receptionniste, prenom_Receptionniste, email_Receptionniste, 
            telephone_Receptionniste_1, telephone_Receptionniste_2
        )
        VALUES (
            p_nom_Receptionniste, p_prenom_Receptionniste, p_email_Receptionniste, 
            p_telephone_Receptionniste_1, p_telephone_Receptionniste_2
        );

    ELSEIF action = 'READ' THEN
        SELECT * FROM Receptionniste WHERE id_Receptionniste = p_id_Receptionniste;

    ELSEIF action = 'UPDATE' THEN
        UPDATE Receptionniste
        SET nom_Receptionniste = p_nom_Receptionniste,
            prenom_Receptionniste = p_prenom_Receptionniste,
            email_Receptionniste = p_email_Receptionniste,
            telephone_Receptionniste_1 = p_telephone_Receptionniste_1,
            telephone_Receptionniste_2 = p_telephone_Receptionniste_2
        WHERE id_Receptionniste = p_id_Receptionniste;

    ELSEIF action = 'DELETE' THEN
        DELETE FROM Receptionniste WHERE id_Receptionniste = p_id_Receptionniste;

    ELSE
        SIGNAL SQLSTATE '45000'
        SET MESSAGE_TEXT = 'Action non reconnue. Utilisez CREATE, READ, UPDATE ou DELETE.';
    END IF;
END$$

DELIMITER ;

-- procedure user --
DELIMITER $$

CREATE PROCEDURE Users_CRUD(
    IN action VARCHAR(10),
    IN p_id_User INT,
    IN p_user_Name VARCHAR(50),
    IN p_password VARCHAR(50),
    IN p_role VARCHAR(50)
)
BEGIN
    IF action = 'CREATE' THEN
        INSERT INTO Users (user_Name, password, role)
        VALUES (p_user_Name, p_password, p_role);

    ELSEIF action = 'READ' THEN
        SELECT * FROM Users WHERE id_User = p_id_User;

    ELSEIF action = 'UPDATE' THEN
        UPDATE Users
        SET user_Name = p_user_Name,
            password = p_password,
            role = p_role
        WHERE id_User = p_id_User;

    ELSEIF action = 'DELETE' THEN
        DELETE FROM Users WHERE id_User = p_id_User;

    ELSE
        SIGNAL SQLSTATE '45000'
        SET MESSAGE_TEXT = 'Action non reconnue. Utilisez CREATE, READ, UPDATE ou DELETE.';
    END IF;
END$$

DELIMITER ;
-- Procedure chambre --
DELIMITER $$

CREATE PROCEDURE Chambre_CRUD(
    IN action VARCHAR(10),
    IN p_id_Chambre INT,
    IN p_capacite INT,
    IN p_numero_Lit INT
)
BEGIN
    IF action = 'CREATE' THEN
        INSERT INTO Chambre (capacite, numero_Lit)
        VALUES (p_capacite, p_numero_Lit);

    ELSEIF action = 'READ' THEN
        SELECT * FROM Chambre WHERE id_Chambre = p_id_Chambre;

    ELSEIF action = 'UPDATE' THEN
        UPDATE Chambre
        SET capacite = p_capacite,
            numero_Lit = p_numero_Lit
        WHERE id_Chambre = p_id_Chambre;

    ELSEIF action = 'DELETE' THEN
        DELETE FROM Chambre WHERE id_Chambre = p_id_Chambre;

    ELSE
        SIGNAL SQLSTATE '45000'
        SET MESSAGE_TEXT = 'Action non reconnue. Utilisez CREATE, READ, UPDATE ou DELETE.';
    END IF;
END$$

DELIMITER ;
--  Procedure patient --
DELIMITER $$

CREATE PROCEDURE Patient_CRUD(
    IN action VARCHAR(10),
    IN p_id_Patient INT,
    IN p_nom_Patient VARCHAR(50),
    IN p_prenom_Patient VARCHAR(50),
    IN p_genre_Patient VARCHAR(10),
    IN p_date_naissance DATE,
    IN p_telephone_Patient_1 VARCHAR(15),
    IN p_telephone_Patient_2 VARCHAR(15),
    IN p_email_Patient VARCHAR(50),
    IN p_adresse_Patient VARCHAR(50),
    IN p_id_Chambre INT
)
BEGIN
    IF action = 'CREATE' THEN
        INSERT INTO Patient (
            nom_Patient, prenom_Patient, genre_Patient, date_naissance, 
            telephone_Patient_1, telephone_Patient_2, email_Patient, 
            adresse_Patient, id_Chambre
        )
        VALUES (
            p_nom_Patient, p_prenom_Patient, p_genre_Patient, p_date_naissance, 
            p_telephone_Patient_1, p_telephone_Patient_2, p_email_Patient, 
            p_adresse_Patient, p_id_Chambre
        );

    ELSEIF action = 'READ' THEN
        SELECT * FROM Patient WHERE id_Patient = p_id_Patient;

    ELSEIF action = 'UPDATE' THEN
        UPDATE Patient
        SET nom_Patient = p_nom_Patient,
            prenom_Patient = p_prenom_Patient,
            genre_Patient = p_genre_Patient,
            date_naissance = p_date_naissance,
            telephone_Patient_1 = p_telephone_Patient_1,
            telephone_Patient_2 = p_telephone_Patient_2,
            email_Patient = p_email_Patient,
            adresse_Patient = p_adresse_Patient,
            id_Chambre = p_id_Chambre
        WHERE id_Patient = p_id_Patient;

    ELSEIF action = 'DELETE' THEN
        DELETE FROM Patient WHERE id_Patient = p_id_Patient;

    ELSE
        SIGNAL SQLSTATE '45000'
        SET MESSAGE_TEXT = 'Action non reconnue. Utilisez CREATE, READ, UPDATE ou DELETE.';
    END IF;
END$$

DELIMITER ;
-- Procedure Dossier_Medical --
DELIMITER $$

CREATE PROCEDURE Dossier_Medical_CRUD(
    IN action VARCHAR(10),
    IN p_id_dossier INT,
    IN p_groupe_Sanguin VARCHAR(5),
    IN p_statut_Rhesus VARCHAR(10),
    IN p_observation VARCHAR(500),
    IN p_date_Ouverture DATETIME,
    IN p_id_Receptionniste INT,
    IN p_id_Patient INT
)
BEGIN
    IF action = 'CREATE' THEN
        INSERT INTO Dossier_Medical (
            groupe_Sanguin, statut_Rhesus, observation, date_Ouverture, 
            id_Receptionniste, id_Patient
        )
        VALUES (
            p_groupe_Sanguin, p_statut_Rhesus, p_observation, p_date_Ouverture, 
            p_id_Receptionniste, p_id_Patient
        );

    ELSEIF action = 'READ' THEN
        SELECT * FROM Dossier_Medical WHERE id_dossier = p_id_dossier;

    ELSEIF action = 'UPDATE' THEN
        UPDATE Dossier_Medical
        SET groupe_Sanguin = p_groupe_Sanguin,
            statut_Rhesus = p_statut_Rhesus,
            observation = p_observation,
            date_Ouverture = p_date_Ouverture,
            id_Receptionniste = p_id_Receptionniste,
            id_Patient = p_id_Patient
        WHERE id_dossier = p_id_dossier;

    ELSEIF action = 'DELETE' THEN
        DELETE FROM Dossier_Medical WHERE id_dossier = p_id_dossier;

    ELSE
        SIGNAL SQLSTATE '45000'
        SET MESSAGE_TEXT = 'Action non reconnue. Utilisez CREATE, READ, UPDATE ou DELETE.';
    END IF;
END$$

DELIMITER ;

-- Procedure feuille --
DELIMITER $$

CREATE PROCEDURE Feuille_CRUD(
    IN action VARCHAR(10),
    IN p_id_Feuille INT,
    IN p_date_Debut DATETIME,
    IN p_date_Fin DATETIME,
    IN p_poids DECIMAL(3,2),
    IN p_Taille VARCHAR(50),
    IN p_Pathologie VARCHAR(300),
    IN p_id_dossier INT
)
BEGIN
    IF action = 'CREATE' THEN
        INSERT INTO Feuille (date_Debut, date_Fin, poids, Taille, Pathologie, id_dossier)
        VALUES (p_date_Debut, p_date_Fin, p_poids, p_Taille, p_Pathologie, p_id_dossier);

    ELSEIF action = 'READ' THEN
        SELECT * FROM Feuille WHERE id_Feuille = p_id_Feuille;

    ELSEIF action = 'UPDATE' THEN
        UPDATE Feuille
        SET date_Debut = p_date_Debut,
            date_Fin = p_date_Fin,
            poids = p_poids,
            Taille = p_Taille,
            Pathologie = p_Pathologie,
            id_dossier = p_id_dossier
        WHERE id_Feuille = p_id_Feuille;

    ELSEIF action = 'DELETE' THEN
        DELETE FROM Feuille WHERE id_Feuille = p_id_Feuille;

    ELSE
        SIGNAL SQLSTATE '45000'
        SET MESSAGE_TEXT = 'Action non reconnue. Utilisez CREATE, READ, UPDATE ou DELETE.';
    END IF;
END$$

DELIMITER ;

-- Procedure Traitement --
DELIMITER $$

CREATE PROCEDURE Traitement_CRUD(
    IN action VARCHAR(10),
    IN p_id_Traitement INT,
    IN p_remarque_Traitement VARCHAR(300),
    IN p_conclusion VARCHAR(100),
    IN p_date_heure DATETIME,
    IN p_id_Salle INT,
    IN p_id_Medecin INT,
    IN p_id_Feuille INT
)
BEGIN
    IF action = 'CREATE' THEN
        INSERT INTO Traitement (remarque_Traitement, conclusion, date_heure, id_Salle, id_Medecin, id_Feuille)
        VALUES (p_remarque_Traitement, p_conclusion, p_date_heure, p_id_Salle, p_id_Medecin, p_id_Feuille);

    ELSEIF action = 'READ' THEN
        SELECT * FROM Traitement WHERE id_Traitement = p_id_Traitement;

    ELSEIF action = 'UPDATE' THEN
        UPDATE Traitement
        SET remarque_Traitement = p_remarque_Traitement,
            conclusion = p_conclusion,
            date_heure = p_date_heure,
            id_Salle = p_id_Salle,
            id_Medecin = p_id_Medecin,
            id_Feuille = p_id_Feuille
        WHERE id_Traitement = p_id_Traitement;

    ELSEIF action = 'DELETE' THEN
        DELETE FROM Traitement WHERE id_Traitement = p_id_Traitement;

    ELSE
        SIGNAL SQLSTATE '45000'
        SET MESSAGE_TEXT = 'Action non reconnue. Utilisez CREATE, READ, UPDATE ou DELETE.';
    END IF;
END$$

DELIMITER ;

-- Procedure Fcature --
DELIMITER $$

CREATE PROCEDURE Facturation_CRUD(
    IN action VARCHAR(10),
    IN p_id_Facturation INT,
    IN p_date_emission DATETIME,
    IN p_est_Payee BOOLEAN,
    IN p_date_Paiement DATETIME,
    IN p_montant DECIMAL(10,2),
    IN p_acteur VARCHAR(50),
    IN p_telephone_Acteur_1 VARCHAR(15),
    IN p_telephone_Acteur_2 VARCHAR(15),
    IN p_id_Patient INT,
    IN p_id_Comptable INT,
    IN p_id_Feuille INT
)
BEGIN
    IF action = 'CREATE' THEN
        INSERT INTO Facturation (
            date_emission, est_Payee, date_Paiement, montant, acteur,
            telephone_Acteur_1, telephone_Acteur_2, id_Patient, id_Comptable, id_Feuille
        ) 
        VALUES (
            p_date_emission, p_est_Payee, p_date_Paiement, p_montant, p_acteur,
            p_telephone_Acteur_1, p_telephone_Acteur_2, p_id_Patient, p_id_Comptable, p_id_Feuille
        );

    ELSEIF action = 'READ' THEN
        SELECT * FROM Facturation WHERE id_Facturation = p_id_Facturation;

    ELSEIF action = 'UPDATE' THEN
        UPDATE Facturation
        SET date_emission = p_date_emission,
            est_Payee = p_est_Payee,
            date_Paiement = p_date_Paiement,
            montant = p_montant,
            acteur = p_acteur,
            telephone_Acteur_1 = p_telephone_Acteur_1,
            telephone_Acteur_2 = p_telephone_Acteur_2,
            id_Patient = p_id_Patient,
            id_Comptable = p_id_Comptable,
            id_Feuille = p_id_Feuille
        WHERE id_Facturation = p_id_Facturation;

    ELSEIF action = 'DELETE' THEN
        DELETE FROM Facturation WHERE id_Facturation = p_id_Facturation;

    ELSE
        SIGNAL SQLSTATE '45000'
        SET MESSAGE_TEXT = 'Action non reconnue. Utilisez CREATE, READ, UPDATE ou DELETE.';
    END IF;
END$$

DELIMITER ;
